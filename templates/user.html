{% extends "base.html" %}
{% import "_macros.html" as macros %}

{% block page_content %}
<div class="page-header">
    <img src="{{ user.gravatar(size=128) }}" style="float: left; margin-right: 20px; border-radius: 5px;">
    
    <h1>{{ user.username }}</h1>
    
    {% if user.profile %}
    <p>
        {% if user.profile.name %}<b>{{ user.profile.name }}</b><br>{% endif %}
        {% if user.profile.location %}From {{ user.profile.location }}<br>{% endif %}
        {% if user.profile.about_me %}{{ user.profile.about_me }}<br>{% endif %}
    </p>
    {% endif %}

    <p>
        Member since: {{ moment(user.member_since).format('L') }}. 
        Last seen: {{ moment(user.last_seen).fromNow() }}.
    </p>
    <p>{{ user.posts.count() }} blog posts.</p>
    
    <p>
        <span class="label label-default">Followers: {{ user.followers.count() }}</span> 
        <span class="label label-default">Following: {{ user.followed.count() }}</span>
    </p>
    
    <p>
        {% if user == current_user %}
        <a class="btn btn-default" href="{{ url_for('edit_profile') }}">Edit Profile</a>
        
        {% elif current_user.is_following(user) %}
        <a class="btn btn-primary" href="{{ url_for('unfollow', username=user.username) }}">Unfollow</a>
        {% else %}
        <a class="btn btn-primary" href="{{ url_for('follow', username=user.username) }}">Follow</a>
        {% endif %}
        
        {% if current_user.is_followed_by(user) and user != current_user %}
        <span class="label label-info">Follows you</span>
        {% endif %}
    </p>
</div>

<hr>

<h3>Bài đăng gần đây của {{ user.username }}</h3>
{% include '_posts.html' %} 

{% endblock %}